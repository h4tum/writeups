
import z3
import struct
from more_itertools import chunked, windowed

from collections import defaultdict

# Create flag

import z3

s = z3.Solver()
flag = [z3.BitVec(f'f{i}', 8) for i in range(20)]

def z3_isdigit(f):
    return z3.And(f >= ord('0'), f <= ord('9'))

def z3_isupper(f):
    return z3.And(f >= ord('A'), f <= ord('Z'))

# General flag format
for f in flag:
    s.add(z3.Or(z3_isdigit(f), z3_isupper(f)))



## bin1 constraints
# characters are of 067889BBCKKMOPPUVWYY
all_chars = "067889BBCKKMOPPUVWYY"

# compute counts
for c in set(all_chars):
    cnt = all_chars.count(c)
    rcnt = z3.IntVal(0)
    for f in flag:
        rcnt += z3.If(f == ord(c), 1, 0)
    s.add(cnt == rcnt)


## bin2 sums of numbers and capital chars
number_sums      = [  0,  7, 14, 17 ]
capitalized_sums = [ 61, 36, 44, 50 ]

for part in range(4):
    sum_n = z3.BitVecVal(0, 8)
    sum_c = z3.BitVecVal(0, 8)
    for part_idx in range(5):
        flag_idx = part * 5 + part_idx
        c = flag[flag_idx]
        sum_n += z3.If(z3_isdigit(c), c - ord('0'), 0)
        sum_c += z3.If(z3_isupper(c), c - ord('A'), 0)
    s.add(number_sums[part] == sum_n)
    s.add(capitalized_sums[part] == sum_c)

## bin3
# bin3 will get index with strchr and the next 0x18 characters in the array starting at idx * 0x60 are allowed to be the next
# strchr of ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789
_allowed_chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
bin3_allow_array = [ 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x51, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x4e, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x59, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x34, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x57, 0x00, 0x00, 0x00, 0x4b, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x4f, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x38, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x32, 0x00, 0x00, 0x00, 0x4c, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x47, 0x00, 0x00, 0x00, 0x39, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x5a, 0x00, 0x00, 0x00, 0x49, 0x00, 0x00, 0x00, 0x35, 0x00, 0x00, 0x00, 0x54, 0x00, 0x00, 0x00, 0x45, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0x00, 0x33, 0x00, 0x00, 0x00, 0x4a, 0x00, 0x00, 0x00, 0x43, 0x00, 0x00, 0x00, 0x55, 0x00, 0x00, 0x00, 0x53, 0x00, 0x00, 0x00, 0x31, 0x00, 0x00, 0x00, 0x46, 0x00, 0x00, 0x00, 0x41, 0x00, 0x00, 0x00, 0x4d, 0x00, 0x00, 0x00, 0x37, 0x00, 0x00, 0x00, 0x52, 0x00, 0x00, 0x00, 0x56, 0x00, 0x00, 0x00, 0x42, 0x00, 0x00, 0x00, 0x36, 0x00, 0x00, 0x00, 0x50 ]

for c in all_chars:
    idx = _allowed_chars.index(c)
    c_allowed_chars = [bin3_allow_array[0x60*idx + i+3] for i in range(0, 0x60, 0x4)]
    c_allowed_chars = list(filter(lambda x: chr(x) in all_chars, c_allowed_chars))

    for f1,f2 in windowed(flag,2):
        s.add(z3.Implies(f1 == ord(c), z3.Or(*[f2 == ca for ca in c_allowed_chars])))



## bin4
# for each idx it will check check_arr[idx:idx+10] and if match_field equals the val, then match_idx must be match_val

# flag[15] = 'Y'
# flag[17] = 'M'
# flag[18] = '8'

s.add(flag[15] == ord('Y'))
s.add(flag[17] == ord('M'))
s.add(flag[18] == ord('8'))


bin4_check_array = b'\x00\x00\x00\x00\x49\x00\x00\x00\x12\x00\x00\x00\x35\x00\x00\x00\x00\x00\x00\x00\x59\x00\x00\x00\x0b\x00\x00\x00\x4f\x00\x00\x00\x00\x00\x00\x00\x56\x00\x00\x00\x0e\x00\x00\x00\x55\x00\x00\x00\x00\x00\x00\x00\x4c\x00\x00\x00\x06\x00\x00\x00\x49\x00\x00\x00\x00\x00\x00\x00\x36\x00\x00\x00\x04\x00\x00\x00\x5a\x00\x00\x00\x00\x00\x00\x00\x37\x00\x00\x00\x03\x00\x00\x00\x57\x00\x00\x00\x00\x00\x00\x00\x31\x00\x00\x00\x11\x00\x00\x00\x49\x00\x00\x00\x00\x00\x00\x00\x58\x00\x00\x00\x08\x00\x00\x00\x33\x00\x00\x00\x00\x00\x00\x00\x37\x00\x00\x00\x0c\x00\x00\x00\x4d\x00\x00\x00\x00\x00\x00\x00\x43\x00\x00\x00\x0d\x00\x00\x00\x43\x00\x00\x00\x01\x00\x00\x00\x4a\x00\x00\x00\x03\x00\x00\x00\x54\x00\x00\x00\x01\x00\x00\x00\x55\x00\x00\x00\x00\x00\x00\x00\x34\x00\x00\x00\x01\x00\x00\x00\x50\x00\x00\x00\x0b\x00\x00\x00\x42\x00\x00\x00\x01\x00\x00\x00\x4c\x00\x00\x00\x02\x00\x00\x00\x47\x00\x00\x00\x01\x00\x00\x00\x56\x00\x00\x00\x12\x00\x00\x00\x36\x00\x00\x00\x01\x00\x00\x00\x44\x00\x00\x00\x0f\x00\x00\x00\x35\x00\x00\x00\x01\x00\x00\x00\x4d\x00\x00\x00\x05\x00\x00\x00\x4f\x00\x00\x00\x01\x00\x00\x00\x4d\x00\x00\x00\x0d\x00\x00\x00\x54\x00\x00\x00\x01\x00\x00\x00\x38\x00\x00\x00\x07\x00\x00\x00\x55\x00\x00\x00\x01\x00\x00\x00\x58\x00\x00\x00\x11\x00\x00\x00\x50\x00\x00\x00\x02\x00\x00\x00\x58\x00\x00\x00\x05\x00\x00\x00\x44\x00\x00\x00\x02\x00\x00\x00\x59\x00\x00\x00\x00\x00\x00\x00\x4b\x00\x00\x00\x02\x00\x00\x00\x4d\x00\x00\x00\x03\x00\x00\x00\x56\x00\x00\x00\x02\x00\x00\x00\x59\x00\x00\x00\x0d\x00\x00\x00\x5a\x00\x00\x00\x02\x00\x00\x00\x47\x00\x00\x00\x0c\x00\x00\x00\x4f\x00\x00\x00\x02\x00\x00\x00\x45\x00\x00\x00\x13\x00\x00\x00\x57\x00\x00\x00\x02\x00\x00\x00\x31\x00\x00\x00\x07\x00\x00\x00\x58\x00\x00\x00\x02\x00\x00\x00\x46\x00\x00\x00\x08\x00\x00\x00\x46\x00\x00\x00\x02\x00\x00\x00\x45\x00\x00\x00\x01\x00\x00\x00\x55\x00\x00\x00\x02\x00\x00\x00\x52\x00\x00\x00\x0b\x00\x00\x00\x51\x00\x00\x00\x03\x00\x00\x00\x44\x00\x00\x00\x13\x00\x00\x00\x50\x00\x00\x00\x03\x00\x00\x00\x39\x00\x00\x00\x01\x00\x00\x00\x58\x00\x00\x00\x03\x00\x00\x00\x4e\x00\x00\x00\x0b\x00\x00\x00\x51\x00\x00\x00\x03\x00\x00\x00\x4c\x00\x00\x00\x09\x00\x00\x00\x52\x00\x00\x00\x03\x00\x00\x00\x45\x00\x00\x00\x0c\x00\x00\x00\x48\x00\x00\x00\x03\x00\x00\x00\x59\x00\x00\x00\x0e\x00\x00\x00\x30\x00\x00\x00\x03\x00\x00\x00\x4a\x00\x00\x00\x06\x00\x00\x00\x41\x00\x00\x00\x03\x00\x00\x00\x47\x00\x00\x00\x00\x00\x00\x00\x30\x00\x00\x00\x03\x00\x00\x00\x52\x00\x00\x00\x08\x00\x00\x00\x38\x00\x00\x00\x03\x00\x00\x00\x56\x00\x00\x00\x07\x00\x00\x00\x36\x00\x00\x00\x04\x00\x00\x00\x39\x00\x00\x00\x00\x00\x00\x00\x42\x00\x00\x00\x04\x00\x00\x00\x4a\x00\x00\x00\x10\x00\x00\x00\x45\x00\x00\x00\x04\x00\x00\x00\x37\x00\x00\x00\x06\x00\x00\x00\x32\x00\x00\x00\x04\x00\x00\x00\x4b\x00\x00\x00\x11\x00\x00\x00\x4d\x00\x00\x00\x04\x00\x00\x00\x4a\x00\x00\x00\x0f\x00\x00\x00\x59\x00\x00\x00\x04\x00\x00\x00\x33\x00\x00\x00\x08\x00\x00\x00\x54\x00\x00\x00\x04\x00\x00\x00\x33\x00\x00\x00\x01\x00\x00\x00\x54\x00\x00\x00\x04\x00\x00\x00\x4c\x00\x00\x00\x03\x00\x00\x00\x42\x00\x00\x00\x04\x00\x00\x00\x52\x00\x00\x00\x0d\x00\x00\x00\x48\x00\x00\x00\x04\x00\x00\x00\x32\x00\x00\x00\x0b\x00\x00\x00\x57\x00\x00\x00\x05\x00\x00\x00\x42\x00\x00\x00\x0b\x00\x00\x00\x56\x00\x00\x00\x05\x00\x00\x00\x4a\x00\x00\x00\x13\x00\x00\x00\x30\x00\x00\x00\x05\x00\x00\x00\x31\x00\x00\x00\x12\x00\x00\x00\x52\x00\x00\x00\x05\x00\x00\x00\x36\x00\x00\x00\x06\x00\x00\x00\x4d\x00\x00\x00\x05\x00\x00\x00\x54\x00\x00\x00\x00\x00\x00\x00\x44\x00\x00\x00\x05\x00\x00\x00\x4b\x00\x00\x00\x0e\x00\x00\x00\x57\x00\x00\x00\x05\x00\x00\x00\x42\x00\x00\x00\x0f\x00\x00\x00\x4a\x00\x00\x00\x05\x00\x00\x00\x45\x00\x00\x00\x10\x00\x00\x00\x44\x00\x00\x00\x05\x00\x00\x00\x55\x00\x00\x00\x11\x00\x00\x00\x4c\x00\x00\x00\x05\x00\x00\x00\x4b\x00\x00\x00\x04\x00\x00\x00\x4b\x00\x00\x00\x06\x00\x00\x00\x52\x00\x00\x00\x05\x00\x00\x00\x32\x00\x00\x00\x06\x00\x00\x00\x46\x00\x00\x00\x13\x00\x00\x00\x42\x00\x00\x00\x06\x00\x00\x00\x4f\x00\x00\x00\x0d\x00\x00\x00\x4d\x00\x00\x00\x06\x00\x00\x00\x53\x00\x00\x00\x0b\x00\x00\x00\x56\x00\x00\x00\x06\x00\x00\x00\x30\x00\x00\x00\x0f\x00\x00\x00\x59\x00\x00\x00\x06\x00\x00\x00\x32\x00\x00\x00\x09\x00\x00\x00\x4d\x00\x00\x00\x06\x00\x00\x00\x33\x00\x00\x00\x0a\x00\x00\x00\x36\x00\x00\x00\x06\x00\x00\x00\x56\x00\x00\x00\x00\x00\x00\x00\x42\x00\x00\x00\x06\x00\x00\x00\x5a\x00\x00\x00\x0e\x00\x00\x00\x30\x00\x00\x00\x06\x00\x00\x00\x42\x00\x00\x00\x01\x00\x00\x00\x44\x00\x00\x00\x07\x00\x00\x00\x58\x00\x00\x00\x12\x00\x00\x00\x38\x00\x00\x00\x07\x00\x00\x00\x31\x00\x00\x00\x0f\x00\x00\x00\x57\x00\x00\x00\x07\x00\x00\x00\x33\x00\x00\x00\x02\x00\x00\x00\x50\x00\x00\x00\x07\x00\x00\x00\x4f\x00\x00\x00\x0a\x00\x00\x00\x41\x00\x00\x00\x07\x00\x00\x00\x34\x00\x00\x00\x08\x00\x00\x00\x4a\x00\x00\x00\x07\x00\x00\x00\x46\x00\x00\x00\x11\x00\x00\x00\x55\x00\x00\x00\x07\x00\x00\x00\x39\x00\x00\x00\x05\x00\x00\x00\x34\x00\x00\x00\x07\x00\x00\x00\x52\x00\x00\x00\x06\x00\x00\x00\x51\x00\x00\x00\x07\x00\x00\x00\x55\x00\x00\x00\x0e\x00\x00\x00\x4e\x00\x00\x00\x07\x00\x00\x00\x4f\x00\x00\x00\x10\x00\x00\x00\x48\x00\x00\x00\x08\x00\x00\x00\x4e\x00\x00\x00\x0f\x00\x00\x00\x4b\x00\x00\x00\x08\x00\x00\x00\x33\x00\x00\x00\x12\x00\x00\x00\x54\x00\x00\x00\x08\x00\x00\x00\x34\x00\x00\x00\x0a\x00\x00\x00\x4f\x00\x00\x00\x08\x00\x00\x00\x38\x00\x00\x00\x11\x00\x00\x00\x39\x00\x00\x00\x08\x00\x00\x00\x56\x00\x00\x00\x0b\x00\x00\x00\x54\x00\x00\x00\x08\x00\x00\x00\x4d\x00\x00\x00\x13\x00\x00\x00\x47\x00\x00\x00\x08\x00\x00\x00\x43\x00\x00\x00\x10\x00\x00\x00\x58\x00\x00\x00\x08\x00\x00\x00\x34\x00\x00\x00\x0c\x00\x00\x00\x37\x00\x00\x00\x08\x00\x00\x00\x52\x00\x00\x00\x06\x00\x00\x00\x46\x00\x00\x00\x08\x00\x00\x00\x4e\x00\x00\x00\x0d\x00\x00\x00\x50\x00\x00\x00\x09\x00\x00\x00\x52\x00\x00\x00\x05\x00\x00\x00\x52\x00\x00\x00\x09\x00\x00\x00\x33\x00\x00\x00\x07\x00\x00\x00\x41\x00\x00\x00\x09\x00\x00\x00\x49\x00\x00\x00\x03\x00\x00\x00\x47\x00\x00\x00\x09\x00\x00\x00\x59\x00\x00\x00\x11\x00\x00\x00\x58\x00\x00\x00\x09\x00\x00\x00\x54\x00\x00\x00\x0b\x00\x00\x00\x41\x00\x00\x00\x09\x00\x00\x00\x32\x00\x00\x00\x10\x00\x00\x00\x33\x00\x00\x00\x09\x00\x00\x00\x47\x00\x00\x00\x00\x00\x00\x00\x52\x00\x00\x00\x09\x00\x00\x00\x42\x00\x00\x00\x06\x00\x00\x00\x33\x00\x00\x00\x09\x00\x00\x00\x51\x00\x00\x00\x0f\x00\x00\x00\x4c\x00\x00\x00\x09\x00\x00\x00\x34\x00\x00\x00\x0d\x00\x00\x00\x56\x00\x00\x00\x0a\x00\x00\x00\x57\x00\x00\x00\x02\x00\x00\x00\x51\x00\x00\x00\x0a\x00\x00\x00\x30\x00\x00\x00\x09\x00\x00\x00\x4e\x00\x00\x00\x0a\x00\x00\x00\x4d\x00\x00\x00\x06\x00\x00\x00\x36\x00\x00\x00\x0a\x00\x00\x00\x33\x00\x00\x00\x0b\x00\x00\x00\x58\x00\x00\x00\x0a\x00\x00\x00\x49\x00\x00\x00\x0c\x00\x00\x00\x38\x00\x00\x00\x0a\x00\x00\x00\x52\x00\x00\x00\x0f\x00\x00\x00\x46\x00\x00\x00\x0a\x00\x00\x00\x57\x00\x00\x00\x0e\x00\x00\x00\x41\x00\x00\x00\x0a\x00\x00\x00\x45\x00\x00\x00\x05\x00\x00\x00\x34\x00\x00\x00\x0a\x00\x00\x00\x55\x00\x00\x00\x11\x00\x00\x00\x4b\x00\x00\x00\x0a\x00\x00\x00\x33\x00\x00\x00\x03\x00\x00\x00\x41\x00\x00\x00\x0b\x00\x00\x00\x4f\x00\x00\x00\x00\x00\x00\x00\x34\x00\x00\x00\x0b\x00\x00\x00\x4d\x00\x00\x00\x08\x00\x00\x00\x53\x00\x00\x00\x0b\x00\x00\x00\x4a\x00\x00\x00\x11\x00\x00\x00\x52\x00\x00\x00\x0b\x00\x00\x00\x5a\x00\x00\x00\x05\x00\x00\x00\x47\x00\x00\x00\x0b\x00\x00\x00\x52\x00\x00\x00\x0c\x00\x00\x00\x41\x00\x00\x00\x0b\x00\x00\x00\x39\x00\x00\x00\x0d\x00\x00\x00\x31\x00\x00\x00\x0b\x00\x00\x00\x32\x00\x00\x00\x02\x00\x00\x00\x50\x00\x00\x00\x0b\x00\x00\x00\x32\x00\x00\x00\x0e\x00\x00\x00\x48\x00\x00\x00\x0b\x00\x00\x00\x34\x00\x00\x00\x10\x00\x00\x00\x54\x00\x00\x00\x0b\x00\x00\x00\x42\x00\x00\x00\x01\x00\x00\x00\x50\x00\x00\x00\x0c\x00\x00\x00\x38\x00\x00\x00\x01\x00\x00\x00\x50\x00\x00\x00\x0c\x00\x00\x00\x4f\x00\x00\x00\x01\x00\x00\x00\x43\x00\x00\x00\x0c\x00\x00\x00\x54\x00\x00\x00\x0b\x00\x00\x00\x31\x00\x00\x00\x0c\x00\x00\x00\x34\x00\x00\x00\x0d\x00\x00\x00\x36\x00\x00\x00\x0c\x00\x00\x00\x37\x00\x00\x00\x06\x00\x00\x00\x54\x00\x00\x00\x0c\x00\x00\x00\x35\x00\x00\x00\x07\x00\x00\x00\x45\x00\x00\x00\x0c\x00\x00\x00\x50\x00\x00\x00\x13\x00\x00\x00\x53\x00\x00\x00\x0c\x00\x00\x00\x4d\x00\x00\x00\x0e\x00\x00\x00\x4a\x00\x00\x00\x0c\x00\x00\x00\x50\x00\x00\x00\x09\x00\x00\x00\x49\x00\x00\x00\x0c\x00\x00\x00\x57\x00\x00\x00\x10\x00\x00\x00\x41\x00\x00\x00\x0d\x00\x00\x00\x5a\x00\x00\x00\x02\x00\x00\x00\x37\x00\x00\x00\x0d\x00\x00\x00\x4e\x00\x00\x00\x00\x00\x00\x00\x38\x00\x00\x00\x0d\x00\x00\x00\x56\x00\x00\x00\x08\x00\x00\x00\x37\x00\x00\x00\x0d\x00\x00\x00\x45\x00\x00\x00\x07\x00\x00\x00\x36\x00\x00\x00\x0d\x00\x00\x00\x55\x00\x00\x00\x12\x00\x00\x00\x43\x00\x00\x00\x0d\x00\x00\x00\x56\x00\x00\x00\x10\x00\x00\x00\x39\x00\x00\x00\x0d\x00\x00\x00\x57\x00\x00\x00\x05\x00\x00\x00\x44\x00\x00\x00\x0d\x00\x00\x00\x56\x00\x00\x00\x01\x00\x00\x00\x50\x00\x00\x00\x0d\x00\x00\x00\x37\x00\x00\x00\x0f\x00\x00\x00\x36\x00\x00\x00\x0d\x00\x00\x00\x32\x00\x00\x00\x0a\x00\x00\x00\x51\x00\x00\x00\x0e\x00\x00\x00\x34\x00\x00\x00\x0d\x00\x00\x00\x4e\x00\x00\x00\x0e\x00\x00\x00\x46\x00\x00\x00\x09\x00\x00\x00\x36\x00\x00\x00\x0e\x00\x00\x00\x37\x00\x00\x00\x12\x00\x00\x00\x32\x00\x00\x00\x0e\x00\x00\x00\x4b\x00\x00\x00\x0b\x00\x00\x00\x48\x00\x00\x00\x0e\x00\x00\x00\x46\x00\x00\x00\x01\x00\x00\x00\x36\x00\x00\x00\x0e\x00\x00\x00\x57\x00\x00\x00\x04\x00\x00\x00\x4b\x00\x00\x00\x0e\x00\x00\x00\x41\x00\x00\x00\x02\x00\x00\x00\x46\x00\x00\x00\x0e\x00\x00\x00\x30\x00\x00\x00\x06\x00\x00\x00\x59\x00\x00\x00\x0e\x00\x00\x00\x48\x00\x00\x00\x10\x00\x00\x00\x42\x00\x00\x00\x0e\x00\x00\x00\x4e\x00\x00\x00\x0f\x00\x00\x00\x54\x00\x00\x00\x0f\x00\x00\x00\x42\x00\x00\x00\x09\x00\x00\x00\x35\x00\x00\x00\x0f\x00\x00\x00\x59\x00\x00\x00\x0a\x00\x00\x00\x36\x00\x00\x00\x0f\x00\x00\x00\x48\x00\x00\x00\x0d\x00\x00\x00\x30\x00\x00\x00\x0f\x00\x00\x00\x42\x00\x00\x00\x0b\x00\x00\x00\x53\x00\x00\x00\x0f\x00\x00\x00\x4c\x00\x00\x00\x11\x00\x00\x00\x54\x00\x00\x00\x0f\x00\x00\x00\x50\x00\x00\x00\x03\x00\x00\x00\x57\x00\x00\x00\x0f\x00\x00\x00\x4c\x00\x00\x00\x01\x00\x00\x00\x32\x00\x00\x00\x0f\x00\x00\x00\x48\x00\x00\x00\x08\x00\x00\x00\x4f\x00\x00\x00\x0f\x00\x00\x00\x51\x00\x00\x00\x02\x00\x00\x00\x43\x00\x00\x00\x0f\x00\x00\x00\x4e\x00\x00\x00\x10\x00\x00\x00\x34\x00\x00\x00\x10\x00\x00\x00\x39\x00\x00\x00\x0a\x00\x00\x00\x36\x00\x00\x00\x10\x00\x00\x00\x4f\x00\x00\x00\x0b\x00\x00\x00\x51\x00\x00\x00\x10\x00\x00\x00\x42\x00\x00\x00\x06\x00\x00\x00\x4b\x00\x00\x00\x10\x00\x00\x00\x32\x00\x00\x00\x05\x00\x00\x00\x38\x00\x00\x00\x10\x00\x00\x00\x49\x00\x00\x00\x13\x00\x00\x00\x49\x00\x00\x00\x10\x00\x00\x00\x39\x00\x00\x00\x11\x00\x00\x00\x4d\x00\x00\x00\x10\x00\x00\x00\x48\x00\x00\x00\x00\x00\x00\x00\x54\x00\x00\x00\x10\x00\x00\x00\x4a\x00\x00\x00\x01\x00\x00\x00\x32\x00\x00\x00\x10\x00\x00\x00\x57\x00\x00\x00\x0f\x00\x00\x00\x43\x00\x00\x00\x10\x00\x00\x00\x51\x00\x00\x00\x04\x00\x00\x00\x45\x00\x00\x00\x11\x00\x00\x00\x4c\x00\x00\x00\x0f\x00\x00\x00\x44\x00\x00\x00\x11\x00\x00\x00\x52\x00\x00\x00\x04\x00\x00\x00\x4f\x00\x00\x00\x11\x00\x00\x00\x48\x00\x00\x00\x06\x00\x00\x00\x43\x00\x00\x00\x11\x00\x00\x00\x38\x00\x00\x00\x08\x00\x00\x00\x32\x00\x00\x00\x11\x00\x00\x00\x4d\x00\x00\x00\x02\x00\x00\x00\x50\x00\x00\x00\x11\x00\x00\x00\x38\x00\x00\x00\x00\x00\x00\x00\x31\x00\x00\x00\x11\x00\x00\x00\x5a\x00\x00\x00\x0a\x00\x00\x00\x5a\x00\x00\x00\x11\x00\x00\x00\x43\x00\x00\x00\x0d\x00\x00\x00\x31\x00\x00\x00\x11\x00\x00\x00\x33\x00\x00\x00\x12\x00\x00\x00\x33\x00\x00\x00\x11\x00\x00\x00\x4b\x00\x00\x00\x05\x00\x00\x00\x39\x00\x00\x00\x12\x00\x00\x00\x38\x00\x00\x00\x05\x00\x00\x00\x4b\x00\x00\x00\x12\x00\x00\x00\x46\x00\x00\x00\x0b\x00\x00\x00\x4f\x00\x00\x00\x12\x00\x00\x00\x4d\x00\x00\x00\x11\x00\x00\x00\x55\x00\x00\x00\x12\x00\x00\x00\x53\x00\x00\x00\x00\x00\x00\x00\x4b\x00\x00\x00\x12\x00\x00\x00\x46\x00\x00\x00\x03\x00\x00\x00\x31\x00\x00\x00\x12\x00\x00\x00\x31\x00\x00\x00\x0d\x00\x00\x00\x47\x00\x00\x00\x12\x00\x00\x00\x36\x00\x00\x00\x04\x00\x00\x00\x36\x00\x00\x00\x12\x00\x00\x00\x31\x00\x00\x00\x06\x00\x00\x00\x54\x00\x00\x00\x12\x00\x00\x00\x45\x00\x00\x00\x13\x00\x00\x00\x37\x00\x00\x00\x12\x00\x00\x00\x42\x00\x00\x00\x08\x00\x00\x00\x52\x00\x00\x00\x13\x00\x00\x00\x32\x00\x00\x00\x08\x00\x00\x00\x56\x00\x00\x00\x13\x00\x00\x00\x47\x00\x00\x00\x0e\x00\x00\x00\x46\x00\x00\x00\x13\x00\x00\x00\x57\x00\x00\x00\x09\x00\x00\x00\x4d\x00\x00\x00\x13\x00\x00\x00\x43\x00\x00\x00\x0d\x00\x00\x00\x57\x00\x00\x00\x13\x00\x00\x00\x56\x00\x00\x00\x04\x00\x00\x00\x47\x00\x00\x00\x13\x00\x00\x00\x42\x00\x00\x00\x02\x00\x00\x00\x37\x00\x00\x00\x13\x00\x00\x00\x49\x00\x00\x00\x01\x00\x00\x00\x38\x00\x00\x00\x13\x00\x00\x00\x47\x00\x00\x00\x05\x00\x00\x00\x32\x00\x00\x00\x13\x00\x00\x00\x54\x00\x00\x00\x0c\x00\x00\x00\x44\x00\x00\x00\x13\x00\x00\x00\x45\x00\x00\x00\x0b\x00\x00\x00\x42\x00\x00\x00'

for i, f in enumerate(flag):
    for j in range(10):
        _idx = (i * 10 + j) * 0x10
        _, match_val, imply_idx, imply_val = struct.unpack("<IIII", bin4_check_array[_idx:_idx+0x10])

        s.add(z3.Implies(f == match_val, flag[imply_idx] == imply_val))


s.check()
m = s.model()
key = [chr(m[f].as_long()) for f in flag]

print("-".join("".join(kv) for kv in chunked(key, 5)))
